# Preprocessing 

A number of exisiting pipelines are applied to the input sequencing files (FASTQ format) to enable downstream analysis. This directory includes the relevant references and scripts to ensure reproducibility.

### ARTEMIS-DELFI Model

The input features used to train the ARTEMIS-DELFI model are generated by aggregating the features extracted by the DELFI pipeline and the ARTEMIS pipeline.

* For the DELFI pipeline, please refer to:

Genome-wide cell-free DNA fragmentation in patients with cancer
Cristiano et al. Nature, 2019

Detection and characterization of lung cancer using cell-free DNA fragmentomes
Mathios et al. Nat Comm, 2021

https://github.com/cancer-genomics/reproduce_lucas_wflow/tree/master/code/preprocessing


* For the ARTEMIS pipeline, please see:

Genome-wide repeat landscapes in cancer and cell-free DNA
Annapragada et al. Sci Trans Med, 2024

https://github.com/cancer-genomics/artemis2024 



### DECIFER Analysis

The decifer analysis relies on two distinct sources of input data. 

(1) Expression profiles for the transcription factors of interest 

In the current manuscript, we predominantly used gene-level expression data from the TCGA-GTEX-TARGET Expression Dataset available from the UCSC Toil RNAseq Recompute Compendium [1]. Next, we appended this dataset with two independent cell-sorted datasets where the transcriptomes of immune (SRP045500) [2] and brain (SRP064454) [3] cell subpopulations are profiled by RNA-sequencing. For these two datasets, the raw fastq files were retrieved from the SRA and processed through an analysis pipeline mirroring the one described by the UCSC Toil RNAseq Recompute Compendium. The resulting aggregated expression matrix, and the associated metadata table were stored in an R object (merged_tpm.rds), which cannot be included in the workflow due to its large size.

The file `extract_expression_stats.r` reads in the expression matrix, and compares the TF expression of each tumor/cell type to whole blood from healthy individuals.

(2) The relative coverage at TFBS calculated from WGS of plasma cfDNA

Here, we calculate the relative coverage at TFBS following the same procedure used in Mathios et al. [4] and Foda et al. [5]. The script generating the TFBS profile from cfDNA fragment objects (which are generated as part of the DELFI pipeline) can be found at:

https://github.com/cancer-genomics/reproduce_liver_final/blob/master/code/tfbs_coverage-v1-01val.R

The TFBS relative coverage tables for the current brain tumor cohort and the liver cohort are not included in the current workflow due to size limitation.

* References:

[1] Toil enables reproducible, open source, big biomedical data analyses.
Vivian et al. Nat Biotechnol. 2017.

[2] Copy number loss of the interferon gene cluster in melanomas is linked to reduced T cell infiltrate and poor patient prognosis.
Linsley, P.S. et al. PLoS One, 2014.

[3] Purification and Characterization of Progenitor and Mature Human Astrocytes Reveals Transcriptional and Functional Differences with Mouse.
Zhang, Y. et al. Neuron, 2016.

[4] Detection and characterization of lung cancer using cell-free DNA fragmentomes
Mathios et al. Nat Comm, 2021.

[5] Detecting Liver Cancer Using Cell-Free DNA Fragmentomes
Foda et al. Cancer Disc, 2023.


